<html>
<head>
    <title>Route Implementation</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <script src="https://unpkg.com/mustache@2.3.0/mustache.min.js"></script>
    <script type="text/x-template-mustache" id="root">
        <p>hello, world!</p>
    </script>
    <script type="text/x-template-mustache" id="page">
        <p>hello, {{ author }}!</p>
    </script>
</head>
<body>
<h1>Some SPA</h1>
<div id="app"></div>
<script>
    (function() {
        var root = document.getElementById('root').innerHTML;
        Mustache.parse(root);

        var page = document.getElementById('page').innerHTML;
        Mustache.parse(page);

        var path = decodeURI(location.pathname).split('/').filter(function(e){ return e === 0 || e });
        if (!path) {
            document.getElementById('app').innerHTML = Mustache.render(root, {});
        } else {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    document.getElementById('app').innerHTML = Mustache.render(page, response[0]);
                }
            };
            xhr.open("GET", "http://ternary.ca/", true);
            xhr.send();
        }

    })();
</script>
</body>
</html>
